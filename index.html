<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sun Exposure Route Planner - A Fun Pet Project</title>
    <meta name="description" content="Free sun exposure route planner that calculates which side of your car gets sunlight during road trips. Plan seating arrangements, avoid hot spots, and optimize your driving comfort with real-time sun tracking and route analysis.">
    <meta name="author" content="Gabor Vecsei">
    <meta name="robots" content="index, follow">
    <meta name="keywords" content="sun exposure, route planner, road trip, car navigation, sun position, travel planning, driving routes, sun tracking, UV exposure, journey planner">
    <link rel="canonical" href="https://sun.gaborvecsei.com/">
    
    <!-- Enhanced Social Meta -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Sun Exposure Route Planner - A Fun Pet Project">
    <meta property="og:description" content="A fun side project to see which side of your car gets sun exposure during road trips.">
    <meta property="og:url" content="https://sun.gaborvecsei.com/">
    <meta property="og:site_name" content="Sun Exposure Route Planner">
    <meta property="twitter:card" content="summary">
    <meta property="twitter:title" content="Sun Exposure Route Planner - A Fun Pet Project">
    <meta property="twitter:description" content="A fun side project to see which side of your car gets sun exposure during road trips.")
    
    <!-- App Icons -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚òÄÔ∏è</text></svg>">
    <meta name="theme-color" content="#1976d2">
    
    <!-- External Resources with Performance Optimization -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://nominatim.openstreetmap.org">
    <link rel="dns-prefetch" href="https://tile.openstreetmap.org">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] },
                    colors: {
                        border: "hsl(214.3 31.8% 91.4%)", input: "hsl(214.3 31.8% 91.4%)", ring: "hsl(222.2 84% 4.9%)",
                        background: "hsl(0 0% 100%)", foreground: "hsl(222.2 84% 4.9%)",
                        primary: { DEFAULT: "hsl(222.2 47.4% 11.2%)", foreground: "hsl(210 40% 98%)" },
                        secondary: { DEFAULT: "hsl(210 40% 96%)", foreground: "hsl(222.2 84% 4.9%)" },
                        muted: { DEFAULT: "hsl(210 40% 96%)", foreground: "hsl(215.4 16.3% 46.9%)" },
                        accent: { DEFAULT: "hsl(210 40% 96%)", foreground: "hsl(222.2 84% 4.9%)" }
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        .car-marker { filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3)); transition: transform 0.2s ease; }
        .car-marker:hover { transform: scale(1.1); }
        .leaflet-popup-content h4 { margin-top: 0; margin-bottom: 8px; }
        .compass-circle { background: linear-gradient(45deg, #f8f9fa 25%, #fff 25%, #fff 50%, #f8f9fa 50%, #f8f9fa 75%, #fff 75%, #fff); background-size: 20px 20px; }
        .sun-glow { background: radial-gradient(circle, #FFD700 0%, #FFA500 100%); box-shadow: 0 0 15px rgba(255, 215, 0, 0.6); }
        .test-mode-hidden { display: none !important; }
    </style>
    
    <!-- Enhanced Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Sun Exposure Route Planner",
      "description": "A fun pet project to visualize sun exposure on different sides of your car during road trips.",
      "url": "https://sun.gaborvecsei.com/",
      "applicationCategory": "EntertainmentApplication",
      "operatingSystem": "Web Browser",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "author": {
        "@type": "Person",
        "name": "Gabor Vecsei",
        "url": "https://github.com/gaborvecsei"
      },
      "featureList": [
        "Sun position tracking",
        "Route analysis", 
        "Car-side sun exposure estimation",
        "Interactive test mode",
        "Real-time route visualization"
      ],
      "screenshot": "https://sun.gaborvecsei.com/art/exposure_test.png"
    }
    </script>
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-32K7GL7RDQ"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-32K7GL7RDQ', {
            page_title: 'Route Sun Exposure Visualizer',
            custom_map: {custom_parameter_1: 'route_analysis'}
        });
        
        // Error tracking
        window.addEventListener('error', function(e) {
            gtag('event', 'exception', {
                description: e.message,
                fatal: false,
                file: e.filename,
                line: e.lineno
            });
        });
        
        // Track unhandled promise rejections
        window.addEventListener('unhandledrejection', function(e) {
            gtag('event', 'exception', {
                description: 'Unhandled Promise Rejection: ' + e.reason,
                fatal: false
            });
        });
    </script>
</head>
<body class="font-sans bg-background min-h-screen text-foreground leading-relaxed overflow-x-hidden">
    <a href="#main-content" class="absolute -top-10 left-1 bg-primary text-primary-foreground px-2 py-2 no-underline rounded z-[1000] font-semibold focus:top-1">Skip to main content</a>
    <div class="max-w-full m-0 p-0 min-h-screen flex flex-col">
        <header class="px-4 py-4 text-center border-b" role="banner">
            <h1 class="text-lg md:text-xl font-semibold mb-1">‚òÄÔ∏è Sun Exposure Route Planner</h1>
            <p class="text-muted-foreground text-xs md:text-sm">Discover which side of your car gets hit by sun during your journey</p>
        </header>
        
        <!-- Mode Toggle -->
        <div class="px-4 py-2 border-b bg-secondary/20">
            <div class="flex justify-center gap-2">
                <button id="route-mode-btn" class="px-4 py-2 text-sm font-medium bg-primary text-primary-foreground rounded-lg transition-colors" onclick="switchMode('route')">üöó Route Planner</button>
                <button id="test-mode-btn" class="px-4 py-2 text-sm font-medium bg-secondary text-secondary-foreground rounded-lg transition-colors hover:bg-secondary/80" onclick="switchMode('test')">üß™ Test Mode</button>
            </div>
        </div>
        
        <main id="main-content" class="flex-1 flex flex-col md:grid md:grid-cols-[280px_1fr] lg:grid-cols-[280px_1fr_280px] gap-4 h-auto md:h-[600px] p-4" role="main">
            <!-- Route Mode Sidebar -->
            <section id="route-sidebar" class="bg-background rounded-lg p-4 overflow-y-auto border w-full md:w-auto mb-4 md:mb-0 flex-shrink-0" aria-label="Route and sun tracking controls">
                <div class="mb-4">
                    <h3 class="text-base font-semibold mb-3 flex items-center gap-2"><span class="text-sm">üìç</span> Route</h3>
                    <div class="space-y-3">
                        <div>
                            <label for="route-from" class="block text-xs font-medium mb-1">From</label>
                            <input type="text" id="route-from" class="w-full h-8 px-3 py-1 text-sm border border-input rounded-md bg-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring" placeholder="Starting location" aria-describedby="route-from-help">
                            <div id="route-from-help" class="sr-only">Enter your starting location</div>
                        </div>
                        <div>
                            <label for="route-to" class="block text-xs font-medium mb-1">To</label>
                            <input type="text" id="route-to" class="w-full h-8 px-3 py-1 text-sm border border-input rounded-md bg-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring" placeholder="Destination" aria-describedby="route-to-help">
                            <div id="route-to-help" class="sr-only">Enter your destination</div>
                        </div>
                    </div>
                </div>
                
                <div class="mb-4">
                    <h3 class="text-base font-semibold mb-3 flex items-center gap-2"><span class="text-sm">‚òÄÔ∏è</span> Settings</h3>
                    <div class="space-y-3 mb-3">
                        <div>
                            <label for="trip-date" class="block text-xs font-medium mb-1">Date</label>
                            <input type="date" id="trip-date" class="w-full h-8 px-3 py-1 text-sm border border-input rounded-md bg-background focus:outline-none focus:ring-2 focus:ring-ring">
                        </div>
                        <div>
                            <label for="trip-time" class="block text-xs font-medium mb-1">Time (UTC)</label>
                            <input type="time" id="trip-time" class="w-full h-8 px-3 py-1 text-sm border border-input rounded-md bg-background focus:outline-none focus:ring-2 focus:ring-ring">
                        </div>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-secondary rounded-lg border">
                        <label for="analysis-points" class="text-xs font-medium">Points:</label>
                        <input type="number" id="analysis-points" value="12" min="6" max="20" step="1" class="w-16 text-center rounded-md border border-input bg-background px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-ring">
                    </div>
                </div>
                
                <button id="visualize-btn" class="w-full h-8 px-3 py-1 bg-primary text-primary-foreground hover:bg-primary/90 rounded-md text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-ring disabled:opacity-50" type="button" aria-describedby="analyze-help">
                    Analyze
                </button>
                <div id="analyze-help" class="sr-only">Calculate sun exposure for your planned route</div>
            </section>
            
            <!-- Map section -->
            <section class="bg-background rounded-lg relative overflow-hidden border w-full h-[400px] md:h-auto mb-4 md:mb-0 flex-shrink-0" aria-label="Interactive map">
                <div id="map" class="h-full w-full" role="img" aria-label="Interactive route map"></div>
                <div id="status" class="absolute bottom-2 left-2 right-2 p-2 text-center rounded-md text-xs bg-background/95 backdrop-blur-sm border z-[1000] opacity-0 transition-opacity duration-300 [&:not(:empty)]:opacity-100" role="status" aria-live="polite"></div>
            </section>
            
            <!-- Test Mode Sidebar -->
            <section id="test-sidebar" class="test-mode-hidden bg-background rounded-lg p-4 overflow-y-auto border w-full md:w-auto mb-4 md:mb-0 flex-shrink-0" aria-label="Interactive test controls">
                <div class="mb-4">
                    <h3 class="text-base font-semibold mb-3 flex items-center gap-2"><span class="text-sm">üéÆ</span> Interactive Test</h3>
                    <div class="space-y-4">
                        <div>
                            <label for="car-bearing-slider" class="block text-xs font-medium mb-2">üöó Car: <span id="car-bearing-value" class="font-semibold">0¬∞</span> (<span id="car-bearing-compass" class="font-semibold">N</span>)</label>
                            <input type="range" id="car-bearing-slider" min="0" max="360" value="0" step="5" class="w-full" oninput="updateInteractiveTest()">
                        </div>
                        <div>
                            <label for="sun-azimuth-slider" class="block text-xs font-medium mb-2">‚òÄÔ∏è Sun: <span id="sun-azimuth-value" class="font-semibold">0¬∞</span> (<span id="sun-azimuth-compass" class="font-semibold">N</span>)</label>
                            <input type="range" id="sun-azimuth-slider" min="0" max="360" value="0" step="5" class="w-full" oninput="updateInteractiveTest()">
                        </div>
                    </div>
                </div>
                
                <div class="mb-4">
                    <h3 class="text-base font-semibold mb-3 flex items-center gap-2"><span class="text-sm">üìã</span> Test Cases</h3>
                    <div class="grid grid-cols-2 gap-2" id="test-case-buttons"></div>
                </div>
            </section>
            
            <!-- Results panel -->
            <aside id="results-panel" class="bg-background rounded-lg p-4 overflow-y-auto border w-full md:w-auto md:col-span-2 lg:col-span-1 min-h-[300px] flex-shrink-0" aria-label="Sun exposure analysis results">
                <!-- Placeholder when no results -->
                <div id="results-placeholder" class="flex items-center justify-center h-full p-4">
                    <div class="text-center max-w-sm">
                        <div class="text-2xl mb-3">üìä</div>
                        <h3 class="text-base font-semibold mb-2">Results</h3>
                        <p class="text-muted-foreground text-xs leading-relaxed mb-4">Click "Analyze" to see sun exposure data</p>
                        <div class="flex flex-col gap-2">
                            <div class="flex items-center gap-2 px-3 py-2 bg-secondary rounded-lg text-xs border">
                                <span class="text-sm">üåÖ</span>
                                <span>Sun tracking</span>
                            </div>
                            <div class="flex items-center gap-2 px-3 py-2 bg-secondary rounded-lg text-xs border">
                                <span class="text-sm">üéØ</span>
                                <span>Percentages</span>
                            </div>
                            <div class="flex items-center gap-2 px-3 py-2 bg-secondary rounded-lg text-xs border">
                                <span class="text-sm">üöó</span>
                                <span>Side breakdown</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Results container -->
                <div id="car-summary" class="block" style="display: none;">
                    <h3 class="text-center mb-4 text-base font-semibold">‚òÄÔ∏è Sun Exposure Summary</h3>
                    <div class="flex justify-center items-center px-4 py-6">
                        <div class="relative">
                            <!-- Compact car SVG -->
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 240" width="120" class="mx-auto text-muted-foreground" aria-label="Top-down car diagram">
                                <g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
                                    <rect x="20" y="5" width="80" height="230" rx="28"/>
                                    <path d="M30 90 C60 68 60 68 90 90 M30 125 C60 138 60 138 90 125 M30 170 C60 188 60 188 90 170"/>
                                    <path d="M20 95 L10 105 M100 95 L110 105 M50 200 H70"/>
                                    <line x1="10" y1="50" x2="10" y2="90"/><line x1="110" y1="50" x2="110" y2="90"/>
                                    <line x1="10" y1="150" x2="10" y2="190"/><line x1="110" y1="150" x2="110" y2="190"/>
                                    <circle cx="35" cy="12" r="4"/><circle cx="85" cy="12" r="4"/>
                                </g>
                            </svg>
                            
                            <!-- Sun exposure labels -->
                            <div class="absolute -top-6 left-1/2 -translate-x-1/2 text-center">
                                <div class="bg-background border rounded-lg px-2 py-1 shadow-sm">
                                    <div class="text-xs font-medium text-muted-foreground uppercase">Front</div>
                                    <div class="text-sm font-semibold" id="front-percentage">0%</div>
                                </div>
                            </div>
                            <div class="absolute top-1/2 -left-12 -translate-y-1/2 text-center">
                                <div class="bg-background border rounded-lg px-2 py-1 shadow-sm">
                                    <div class="text-xs font-medium text-muted-foreground uppercase">Left</div>
                                    <div class="text-sm font-semibold" id="left-percentage">0%</div>
                                </div>
                            </div>
                            <div class="absolute top-1/2 -right-12 -translate-y-1/2 text-center">
                                <div class="bg-background border rounded-lg px-2 py-1 shadow-sm">
                                    <div class="text-xs font-medium text-muted-foreground uppercase">Right</div>
                                    <div class="text-sm font-semibold" id="right-percentage">0%</div>
                                </div>
                            </div>
                            <div class="absolute -bottom-6 left-1/2 -translate-x-1/2 text-center">
                                <div class="bg-background border rounded-lg px-2 py-1 shadow-sm">
                                    <div class="text-xs font-medium text-muted-foreground uppercase">Back</div>
                                    <div class="text-sm font-semibold" id="back-percentage">0%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Test Mode Results -->
                <div id="test-results" class="test-mode-hidden">
                    <h3 class="text-center mb-4 text-base font-semibold">üß™ Test Results</h3>
                    <div id="test-visualization-container"></div>
                </div>
            </aside>
        </main>


        
        <!-- Route Data Section -->
        <section class="py-8 px-4 bg-secondary/30">
            <div class="max-w-6xl mx-auto">
                <h2 class="text-lg md:text-xl font-bold mb-4 text-center flex items-center justify-center gap-2">
                    <span class="text-lg">üìä</span>
                    Route Data
                </h2>
                <div class="p-4 bg-background rounded-lg border shadow-sm" id="api-data-section">
                    <div id="route-data-content">
                        <p class="text-muted-foreground italic text-center text-sm">Calculate a route above to see the API data being used for analysis...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Information Section -->
        <section class="py-12 px-4">
            <div class="max-w-6xl mx-auto">
                <div class="grid lg:grid-cols-2 gap-8 lg:gap-12">
                    <div>
                        <div class="mb-6">
                            <h2 class="text-lg md:text-xl font-bold mb-4 flex items-center gap-2">
                                <span class="text-lg">üòé</span>
                                Why Check Sun Exposure?
                            </h2>
                            <div class="space-y-4 leading-relaxed">
                                <p class="text-sm text-muted-foreground">This project helps you make smart seating decisions for road trips:</p>
                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                                    <div class="flex items-start gap-3 p-3 bg-secondary/50 rounded-lg">
                                        <span class="text-lg">ü™ë</span>
                                        <div>
                                            <h3 class="font-semibold mb-0.5 text-sm">Choose Your Side</h3>
                                            <p class="text-muted-foreground text-xs">Pick where to sit and avoid the sunny side</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-3 p-3 bg-secondary/50 rounded-lg">
                                        <span class="text-lg">üî•</span>
                                        <div>
                                            <h3 class="font-semibold mb-0.5 text-sm">Let Others Cook</h3>
                                            <p class="text-muted-foreground text-xs">Decide who gets the hot seat on long drives</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-3 p-3 bg-secondary/50 rounded-lg">
                                        <span class="text-lg">üìÖ</span>
                                        <div>
                                            <h3 class="font-semibold mb-0.5 text-sm">Plan Ahead</h3>
                                            <p class="text-muted-foreground text-xs">Know what to expect before you hit the road</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-3 p-3 bg-secondary/50 rounded-lg">
                                        <span class="text-lg">ü§î</span>
                                        <div>
                                            <h3 class="font-semibold mb-0.5 text-sm">Pure Curiosity</h3>
                                            <p class="text-muted-foreground text-xs">Wonder which direction the sun hits during your journey?</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                
                    <div>
                        <div class="mb-6">
                            <h2 class="text-lg md:text-xl font-bold mb-4 flex items-center gap-2">
                                <span class="text-lg">üî¨</span>
                                How Sun Exposure is Calculated
                            </h2>
                            <div class="space-y-4 leading-relaxed">
                                <p class="text-sm text-muted-foreground">This tool provides a <strong>rough estimation</strong> using simplified calculations:</p>
                                
                                <div class="space-y-3">
                                    <div class="p-3 bg-secondary/50 rounded-lg border">
                                        <h3 class="text-sm font-semibold flex items-center gap-2 mb-1">üìç Route & Time Analysis</h3>
                                        <p class="text-muted-foreground text-xs">Uses OpenStreetMap API to get route coordinates and distributes analysis points along the route.</p>
                                    </div>
                                    <div class="p-3 bg-secondary/50 rounded-lg border">
                                        <h3 class="text-sm font-semibold flex items-center gap-2 mb-1">‚òÄÔ∏è Sun Position</h3>
                                        <p class="text-muted-foreground text-xs">Calculates sun position using SunCalc library with UTC times.</p>
                                    </div>
                                    <div class="p-3 bg-secondary/50 rounded-lg border">
                                        <h3 class="text-sm font-semibold flex items-center gap-2 mb-1">üéØ Exposure Estimation</h3>
                                        <p class="text-muted-foreground text-xs">Compares sun direction with car orientation to estimate side exposure.</p>
                                    </div>
                                </div>
                                
                                <div class="p-3 bg-accent/50 rounded-lg border">
                                    <h3 class="text-sm font-semibold mb-2 flex items-center gap-2">‚ö†Ô∏è Limitations</h3>
                                    <p class="text-xs text-muted-foreground">Assumes constant speed, ignores terrain/buildings/trees, perfect weather, direct sunlight only.</p>
                                </div>
                                
                                <div class="mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200 flex items-center justify-between">
                                    <div>
                                        <h3 class="text-sm font-semibold mb-1 flex items-center gap-2">üß™ Interactive Calculator</h3>
                                        <p class="text-xs text-muted-foreground">Test sun exposure calculation with adjustable positions</p>
                                    </div>
                                    <button onclick="switchMode('test')" class="text-xs bg-blue-100 hover:bg-blue-200 text-blue-800 px-3 py-2 rounded-lg border border-blue-300 transition-colors font-medium">Try ‚Üí</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- FAQ Section -->
        <section class="py-12 px-4 bg-secondary/20">
            <div class="max-w-4xl mx-auto">
                <h2 class="text-lg md:text-xl font-bold mb-8 text-center flex items-center justify-center gap-2">
                    <span class="text-lg">‚ùì</span>
                    Frequently Asked Questions
                </h2>
                
                <div class="space-y-6">
                    <div class="bg-background rounded-lg p-4 border">
                        <h3 class="font-semibold mb-2 text-sm">How accurate is the sun exposure calculation?</h3>
                        <p class="text-muted-foreground text-xs">This is a rough estimation for entertainment purposes. It assumes perfect weather, flat terrain, and constant driving speed. Real-world conditions like buildings, trees, and weather will affect actual sun exposure.</p>
                    </div>
                    
                    <div class="bg-background rounded-lg p-4 border">
                        <h3 class="font-semibold mb-2 text-sm">What time zone should I use for the calculation?</h3>
                        <p class="text-muted-foreground text-xs">The tool uses UTC time for all calculations. For best results, convert your local departure time to UTC before entering it in the time field.</p>
                    </div>
                    
                    <div class="bg-background rounded-lg p-4 border">
                        <h3 class="font-semibold mb-2 text-sm">Can I use this for planning which seat to choose?</h3>
                        <p class="text-muted-foreground text-xs">Absolutely! That's one of the main use cases. If the tool shows the right side gets 80% sun exposure, you might want to sit on the left side to stay cooler during your trip.</p>
                    </div>
                    
                    <div class="bg-background rounded-lg p-4 border">
                        <h3 class="font-semibold mb-2 text-sm">What's the difference between Route Planner and Test Mode?</h3>
                        <p class="text-muted-foreground text-xs">Route Planner analyzes real driving routes between two locations. Test Mode lets you manually adjust car and sun positions to understand how the calculations work.</p>
                    </div>
                    
                    <div class="bg-background rounded-lg p-4 border">
                        <h3 class="font-semibold mb-2 text-sm">Why does the analysis show different percentages for each car side?</h3>
                        <p class="text-muted-foreground text-xs">The tool calculates sun exposure based on the angle between the sun's position and your car's orientation at each point along the route, then averages these values to show which sides receive the most direct sunlight.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Call to Action -->
        <section class="py-8 px-4 bg-primary text-center text-primary-foreground">
            <h2 class="text-lg md:text-xl font-bold mb-2 flex items-center justify-center gap-2">üöó Start Planning Your Journey</h2>
            <p class="text-sm opacity-90">A tool to satisfy your curiosity about sun exposure during road trips.</p>
        </section>
        
        <footer class="border-t px-4 py-3 mt-auto">
            <div class="text-center text-xs md:text-sm text-muted-foreground">
                <p>&copy; 2025 Sun Exposure Route Planner | 
                    <a href="https://github.com/gaborvecsei/Car-Route-Visualizer" class="text-primary no-underline hover:underline">GitHub</a> | 
                    <button onclick="switchMode('test')" class="text-primary no-underline hover:underline bg-transparent border-0 cursor-pointer font-inherit text-inherit">üß™ Test Calculator</button> |
                    <span class="italic">A fun pet project for entertainment only</span>
                </p>
            </div>
        </footer>
    </div>
    
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/suncalc@1.9.0/suncalc.js"></script>
    <script src="config.js?v=3"></script>
    <script src="script.js?v=3"></script>
    <script>
        // Test Mode Functionality
        let currentMode = 'route';
        
        const testCases = [
            { name: "Front", carBearing: 0, sunAzimuth: 0 },
            { name: "Back", carBearing: 0, sunAzimuth: 180 },
            { name: "Right", carBearing: 0, sunAzimuth: 90 },
            { name: "Left", carBearing: 0, sunAzimuth: 270 },
            { name: "Front-right", carBearing: 0, sunAzimuth: 45 },
            { name: "Front-left", carBearing: 0, sunAzimuth: 315 },
        ];
        
        const switchMode = (mode) => {
            currentMode = mode;
            const routeElements = ['route-sidebar', 'results-placeholder', 'car-summary'];
            const testElements = ['test-sidebar', 'test-results'];
            const isRoute = mode === 'route';
            
            // Toggle element visibility
            [...routeElements, ...testElements].forEach(id => {
                const el = document.getElementById(id);
                if (!el) return;
                const shouldShow = isRoute ? routeElements.includes(id) : testElements.includes(id);
                el.classList.toggle('test-mode-hidden', !shouldShow);
            });
            
            // Update button styles
            const routeBtn = document.getElementById('route-mode-btn');
            const testBtn = document.getElementById('test-mode-btn');
            const primaryClasses = ['bg-primary', 'text-primary-foreground'];
            const secondaryClasses = ['bg-secondary', 'text-secondary-foreground'];
            
            if (isRoute) {
                routeBtn.classList.add(...primaryClasses);
                routeBtn.classList.remove(...secondaryClasses);
                testBtn.classList.remove(...primaryClasses);
                testBtn.classList.add(...secondaryClasses);
            } else {
                testBtn.classList.add(...primaryClasses);
                testBtn.classList.remove(...secondaryClasses);
                routeBtn.classList.remove(...primaryClasses);
                routeBtn.classList.add(...secondaryClasses);
                initTestMode();
                
                // Smooth scroll to test section
                setTimeout(() => {
                    const testSection = document.getElementById('test-sidebar');
                    if (testSection) {
                        testSection.scrollIntoView({ 
                            behavior: 'smooth', 
                            block: 'start',
                            inline: 'nearest'
                        });
                    }
                }, 150);
            }
        };
        
        const createTestVisualization = (testCase) => {
            const result = calculateCarSideExposures({ azimuth: testCase.sunAzimuth, elevation: 45 }, testCase.carBearing);
            const sunAngle = (testCase.sunAzimuth - 90) * Math.PI / 180;
            const sunX = 50 + Math.cos(sunAngle) * 40;
            const sunY = 50 + Math.sin(sunAngle) * 40;
            
            const exposureBar = (label, value, color) => 
                `<div class="flex items-center my-1">
                    <span class="w-12 text-xs font-medium">${label}:</span>
                    <div class="h-4 rounded ml-2 flex items-center justify-center text-xs font-medium text-white min-w-10" 
                         style="width: ${Math.max(40, value * 120)}px; background: ${color}; text-shadow: 1px 1px 1px rgba(0,0,0,0.5);">
                        ${(value * 100).toFixed(1)}%
                    </div>
                </div>`;
            
            return `
                <div class="mb-4">
                    <div class="text-sm font-semibold mb-3">${testCase.name}</div>
                    <div class="flex gap-6 items-center flex-wrap">
                        <div class="relative w-48 h-48 flex-shrink-0">
                            <div class="w-full h-full border-2 border-gray-300 rounded-full compass-circle">
                                <div class="absolute inset-2 text-xs font-medium text-gray-600">
                                    <div class="absolute top-0 left-1/2 -translate-x-1/2">N</div>
                                    <div class="absolute top-1/2 right-0 -translate-y-1/2">E</div>
                                    <div class="absolute bottom-0 left-1/2 -translate-x-1/2">S</div>
                                    <div class="absolute top-1/2 left-0 -translate-y-1/2">W</div>
                                </div>
                                
                                <svg class="absolute inset-0 w-full h-full z-10">
                                    <line x1="50%" y1="50%" x2="${sunX}%" y2="${sunY}%" stroke="#FFD700" stroke-width="2" opacity="0.8" stroke-dasharray="3,3"/>
                                </svg>
                                
                                <div class="absolute top-1/2 left-1/2 w-8 h-12 z-20" style="transform: translate(-50%, -50%) rotate(${testCase.carBearing}deg);">
                                    <svg width="32" height="48" viewBox="0 0 32 48" class="drop-shadow-sm">
                                        <rect x="6" y="4" width="20" height="40" rx="5" fill="#3b82f6" stroke="#1d4ed8"/>
                                        <rect x="8" y="6" width="16" height="6" rx="2" fill="#60a5fa"/>
                                        <rect x="8" y="36" width="16" height="6" rx="2" fill="#60a5fa"/>
                                        <circle cx="12" cy="2" r="1.5" fill="#fbbf24"/>
                                        <circle cx="20" cy="2" r="1.5" fill="#fbbf24"/>
                                        <text x="16" y="-1" text-anchor="middle" font-size="6" fill="#374151">F</text>
                                        <text x="29" y="26" text-anchor="middle" font-size="6" fill="#374151">R</text>
                                        <text x="16" y="47" text-anchor="middle" font-size="6" fill="#374151">B</text>
                                        <text x="3" y="26" text-anchor="middle" font-size="6" fill="#374151">L</text>
                                    </svg>
                                </div>
                                
                                <div class="absolute w-6 h-6 rounded-full flex items-center justify-center text-sm z-20 sun-glow" 
                                     style="left: ${sunX}%; top: ${sunY}%; transform: translate(-50%, -50%);">‚òÄ</div>
                            </div>
                        </div>
                        
                        <div class="bg-secondary/30 rounded-md p-3 min-w-48 flex-1">
                            <h4 class="text-sm font-semibold mb-2">Exposure Results</h4>
                            ${exposureBar('Front', result.front, 'linear-gradient(to right, #ef4444, #f87171)')}
                            ${exposureBar('Back', result.back, 'linear-gradient(to right, #22c55e, #4ade80)')}
                            ${exposureBar('Left', result.left, 'linear-gradient(to right, #3b82f6, #60a5fa)')}
                            ${exposureBar('Right', result.right, 'linear-gradient(to right, #ec4899, #f472b6)')}
                            <div class="text-xs text-muted-foreground mt-2 space-y-1">
                                <div><strong>Car:</strong> ${getCompassDirection(testCase.carBearing)} (${testCase.carBearing}¬∞)</div>
                                <div><strong>Sun:</strong> ${getCompassDirection(testCase.sunAzimuth)} (${testCase.sunAzimuth}¬∞)</div>
                                <div><strong>Total:</strong> ${((result.front + result.back + result.left + result.right) * 100).toFixed(1)}%</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        };
        
        const updateInteractiveTest = () => {
            const carBearing = parseInt(document.getElementById('car-bearing-slider').value);
            const sunAzimuth = parseInt(document.getElementById('sun-azimuth-slider').value);
            
            // Update display values
            const updates = [
                ['car-bearing-value', carBearing + '¬∞'],
                ['sun-azimuth-value', sunAzimuth + '¬∞'],
                ['car-bearing-compass', getCompassDirection(carBearing)],
                ['sun-azimuth-compass', getCompassDirection(sunAzimuth)]
            ];
            updates.forEach(([id, value]) => {
                document.getElementById(id).textContent = value;
            });
            
            const container = document.getElementById('test-visualization-container');
            container.innerHTML = createTestVisualization({ name: "Interactive Test", carBearing, sunAzimuth });
        };
        
        const runTestCase = (testCase) => {
            document.getElementById('car-bearing-slider').value = testCase.carBearing;
            document.getElementById('sun-azimuth-slider').value = testCase.sunAzimuth;
            updateInteractiveTest();
        };
        
        const initTestMode = () => {
            // Create test case buttons
            const buttonsContainer = document.getElementById('test-case-buttons');
            if (buttonsContainer && buttonsContainer.children.length === 0) {
                testCases.forEach(testCase => {
                    const button = document.createElement('button');
                    button.className = 'px-3 py-2 text-xs bg-secondary hover:bg-secondary/80 rounded-md border transition-colors font-medium';
                    button.textContent = testCase.name;
                    button.onclick = () => runTestCase(testCase);
                    buttonsContainer.appendChild(button);
                });
            }
            
            // Initialize interactive test
            updateInteractiveTest();
        };
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Set up mode toggle
            if (window.location.hash === '#test') {
                switchMode('test');
            }
        });
    </script>
</body>
</html>
